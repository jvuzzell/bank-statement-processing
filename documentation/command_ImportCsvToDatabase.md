# ImportCsvToDatabase Command

The ImportCsvToDatabase command is responsible for importing data from CSV files into specified database tables. This document provides an overview of the purpose, configuration, and usage of the ImportCsvToDatabase command.

## Purpose

The ImportCsvToDatabase command imports data from CSV files generated by other scripts into the appropriate database tables. This allows for further data manipulation, querying, and analysis within the database.

## Prerequisites

Ensure you have the following:

- PHP 7.4 or higher
- Composer dependencies installed
- Database configured and accessible
- Necessary CSV files available

## Directory Structure

- **tmp/reports/**: Directory containing the generated report CSV files.
- **search_terms/**: Directory containing the transaction categories CSV file.

## Configuration

Ensure your config.php file and database connection settings are properly configured.

## Usage

To run the ImportCsvToDatabase command, execute the following from the command line:

```bash
php console.php ImportCsvToDatabase
```

## Process Overview

The command performs the following steps:

1. **Instantiate Importer:**
    - Creates an instance of the ImportCsvToDatabase service.
2. **Import CSV Files:**
    - Imports the recurring-expenses_report.csv into the recurring_expenses table.
    - Imports the transactions_report.csv into the all_transactions table.
    - Imports transaction categories from transaction-categories.csv into the tags_taxonomy table.

## Detailed Breakdown

**1\. Instantiate Importer**

- **Namespace Declaration:**

    Declares the namespace for the script.

    ```php
    use Jvuzzell\\BankStatementProcessing\\library\\services\\commands\\ImportCsvToDatabase;
    ```

- **Instantiate Importer:**

    Creates a new instance of the ImportCsvToDatabase service.

    ```php
    $importer = new ImportCsvToDatabase();
    ```

**2\. Import CSV Files**

- **Import Recurring Expenses Report:**

    Imports data from recurring-expenses_report.csv into the recurring_expenses table.

    ```php
    $importer->importCsv(TMP_REPORTS . 'recurring-expenses_report.csv', 'recurring_expenses');
    ```

- **Import Transactions Report:**

    Imports data from transactions_report.csv into the all_transactions table.

    ```php
    $importer->importCsv(TMP_REPORTS . 'transactions_report.csv', 'all_transactions');
    ```

- **Import Transaction Categories:**

    Imports transaction categories from transaction-categories.csv into the tags_taxonomy table.

    ```php
    $importer->importTagsFromCsv(SEARCH_TERMS_DIR . 'transaction-categories.csv', 'tags_taxonomy');
    ```

## Classes and Methods

- **ImportCsvToDatabase**:
  - importCsv($csvFilePath, $tableName): Imports data from the specified CSV file into the given database table.
  - importTagsFromCsv($csvFilePath, $tableName): Imports tag data from the specified CSV file into the given database table.

## Conclusion

The ImportCsvToDatabase command is essential for loading CSV data into the database for further analysis. By following the steps outlined in this guide, you can successfully run the command and ensure that your CSV data is imported into the appropriate database tables.